"use strict";var rPApp=angular.module("myApp",["ngRoute","myApp.version"]);rPApp.config(["$locationProvider","$routeProvider",function(a,b){b.when("/:id",{reloadOnSearch:false});b.otherwise({redirectTo:"/:id"});a.html5Mode(true)}]);rPApp.controller("rPAppCtrl",["$scope","$location","$routeParams","$http",function(a,g,b,f){a.pageDirective="";a.url=g.absUrl();a.platform="";a.isWeChat=false;var e=g.path();var d=e.substring(1,e.length);console.log(e+new Date());if(/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)){a.pageDirective="mobileContent";a.platform="iOS"}else{if(/(Android)/i.test(navigator.userAgent)){a.pageDirective="mobileContent";a.platform="Android"}else{a.pageDirective="pcContent";a.platform="PC"}}var c=window.location.protocol;f.get(c+"//api.izhihuidao.com/AppApi/api/appversion/getAppDetails/"+d).success(function(i){console.log(i);if(i.ReturnCode!=1){a.pageDirective="errorContent"}else{a.viewData=i.Result;var h=i.Result.AppVersions;if(h[0].Platform=="安卓"){a.AndroidVersion=h[0];if(h.length>1){a.iOSVersion=h[1]}}else{a.iOSVersion=h[0];if(h.length>1){a.AndroidVersion=h[1]}}if(a.platform=="iOS"){if(a.iOSVersion){a.Version=a.iOSVersion;a.isAndroid=false}else{a.pageDirective="errorContent"}}else{if(a.platform=="Android"){if(a.AndroidVersion){a.Version=a.AndroidVersion;a.isAndroid=true}else{a.pageDirective="errorContent"}}}}document.title=a.viewData.AppName+" - 下载"}).error(function(){a.pageDirective="errorContent"}).then(function(){var k=a.viewData.AppName+" - 下载";var i=a.viewData.Icon;var h=a.viewData.Description||"i智慧岛应用发布系统";shareStyleSet(k,i,h);var j=g.absUrl();$(document).find("#code").qrcode({render:"table",width:100,height:100,text:j})});a.download=function(i,h){if(/(MicroMessenger)/i.test(navigator.userAgent)){a.isWeChat=true}else{if(/(QQ)/i.test(navigator.userAgent)){a.isWeChat=true}}var j="";if(i=="企业版"){j="itms-services://?action=download-manifest&url="+h}else{j=h}window.location.href=j};a.pcDowmload=function(h){window.location.href=h}}]);var tempTime=new Date().getTime();rPApp.directive("pcContent",function(){return{restrict:"EA",replace:true,transclude:true,templateUrl:"pc/pcView.html?time="+tempTime,link:function(c,b,a){}}});rPApp.directive("mobileContent",function(){return{restrict:"EA",replace:true,transclude:true,templateUrl:"mobile/mobileView.html?time="+tempTime,link:function(c,b,a){}}});rPApp.directive("errorContent",function(){return{restrict:"EA",replace:true,transclude:true,templateUrl:"error/error.html?time="+tempTime,link:function(c,b,a){}}});rPApp.directive("wechatNotice",function(){return{restrict:"EA",replace:true,transclude:true,template:'<div style="width:100%;height:160px;background-color: #555555;color: white;position: relative;z-index: -2;"><div class="animated wobble" style="width: 60%;position: fixed;top: 50px;left: 65px;z-index: -1;"><div>请点击有上角菜单</div><div>在默认浏览器中打开并安装应用</div></div><img class="animated wobble" style="height:4em;width: 4em;position: fixed;top:20px;right:20px;z-index: -1;" src="image/short-arrow.png"></div>',link:function(c,b,a){}}});